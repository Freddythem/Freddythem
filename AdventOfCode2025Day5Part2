using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Diagnostics.Metrics;
using System.Numerics;
using System.Security;

class Program
{
    static void Main()
    {
        string filePath = "E:\\04_Programmierung\\AdventOfCode2025\\Input.txt";
        int lineNumber = 0;
        string[] inputFile;

        long numberOfFreshIngredients = 0;

        List<string> freshRanges = new List<string>();

        List<long> startIds = new List<long>();
        List<long> endIds = new List<long>();

        try
        {
            using (StreamReader sr = new StreamReader(filePath))
            {
                lineNumber = File.ReadLines(filePath).Count();
                inputFile = new string[lineNumber];
                bool emptyLine = false;

                for (int i = 0; i < lineNumber; i++)
                {
                    inputFile[i] = sr.ReadLine();
                }

                Console.WriteLine($"Neues Programm. Alle Daten aus Input.txt eingelesen. Zeilen: {lineNumber}\n");

                for (int i = 0; i < inputFile.Length; i++)
                {
                    if (inputFile[i] == "")
                    {
                        emptyLine = true;
                        i++;
                    }
                    if (!emptyLine)
                    {
                        freshRanges.Add(inputFile[i]);
                    }
                }

                string[] idRange = new string[1];

                for (int i = 0; i < freshRanges.Count; i++)
                {
                    idRange = freshRanges[i].Split("-");
                    startIds.Add(long.Parse(idRange[0]));
                    endIds.Add(long.Parse(idRange[1]));
                }

                long idFirst = 0;
                long idEnd = 0;

                for (int i = 0; i < startIds.Count; i++)
                {
                    idFirst = startIds[i];
                    idEnd = endIds[i];
                    int counter = 0;

                    while (counter < startIds.Count)
                    {
                        if ((idEnd >= startIds[counter]) && idEnd < endIds[counter])
                        {
                            idEnd = endIds[counter];
                            counter = 0;
                        }
                        counter++;
                    }

                    if (endIds[i] != idEnd)
                    {
                        endIds[i] = idEnd;
                    }

                    counter = 0;

                    while (counter < startIds.Count)
                    {
                        if ((idFirst <= endIds[counter]) && idFirst > startIds[counter])
                        {
                            idFirst = startIds[counter];
                            counter = 0;
                        }
                        counter++;
                    }

                    if (startIds[i] != idFirst)
                    {
                        startIds[i] = idFirst;
                    }
                }

                for (int i = 1; i < startIds.Count; i++)
                {
                    int counterFirst = i + 1;
                    while (counterFirst < startIds.Count)
                    {
                        idFirst = startIds[i - 1];
                        idEnd = endIds[i - 1];

                        if (idFirst == startIds[counterFirst] && idEnd == endIds[counterFirst])
                        {
                            startIds.RemoveAt(counterFirst);
                            endIds.RemoveAt(counterFirst);
                            counterFirst -= 1;
                        }
                        counterFirst++;
                    }
                }
            
                for (int i = 0; i < startIds.Count; i++)
                {
                    long diff = (endIds[i] - startIds[i]) + 1;
                    numberOfFreshIngredients += diff;
                }

                Console.WriteLine($"\nfreshIngredients: {numberOfFreshIngredients}");
            }
        }
        catch (Exception e)
        {
            Console.WriteLine("Fehler: " + e.Message);
        }
    }
}
