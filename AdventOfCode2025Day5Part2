using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Diagnostics.Metrics;
using System.Numerics;
using System.Security;

class Program
{
    static void Main()
    {
        string filePath = "C:\\Users\\meierf\\source\\repos\\ConsoleApp1\\ConsoleApp1\\Input.txt";
        int lineNumber = 0;
        string[] inputFile;

        long numberOfFreshIngredients = 0;

        List<string> freshRanges = new List<string>();
        List<long> freshIngredients = new List<long>();

        List<long> startIds = new List<long>();
        List<long> endIds = new List<long>();

        try
        {
            using (StreamReader sr = new StreamReader(filePath))
            {
                lineNumber = File.ReadLines(filePath).Count();
                inputFile = new string[lineNumber];
                bool emptyLine = false;

                for (int i = 0; i < lineNumber; i++)
                {
                    inputFile[i] = sr.ReadLine();
                }

                Console.WriteLine($"Neues Programm. Alle Daten aus Input.txt eingelesen. Zeilen: {lineNumber}\n");

                for (int i = 0; i < inputFile.Length; i++)
                {
                    if (inputFile[i] == "")
                    {
                        emptyLine = true;
                        i++;
                    }
                    if (!emptyLine)
                    {
                        freshRanges.Add(inputFile[i]);
                    }
                }

                string[] idRange = new string[1];

                for (int i = 0; i < freshRanges.Count; i++)
                {
                    idRange = freshRanges[i].Split("-");
                    startIds.Add(long.Parse(idRange[0]));
                    endIds.Add(long.Parse(idRange[1]));
                }


                long idFirst = 0;
                long idEnd = 0;

                for (int i = 0; i < startIds.Count; i++)
                {
                    idFirst = startIds[i];
                    idEnd = endIds[i];
                    int counter = 0;

                    while (counter < startIds.Count)
                    {
                        //Console.WriteLine($"counter: {counter} - i: {i} ");

                        if ((idEnd >= startIds[counter]) && idEnd < endIds[counter])
                        {
                            idEnd = endIds[counter];
                            counter = 0;
                        }                    
                        counter++;                    
                    }
                    //startIds.RemoveAt(counter);
                    //endIds.RemoveAt(counter);
                    if(endIds[i] != idEnd)
                    {
                    Console.WriteLine($"Id-Ende {i} angepasst: {endIds[i]} jetzt {idEnd} ");
                    endIds[i] = idEnd;
                    }

                    counter = 0;

                    while (counter < startIds.Count)
                    {
                        //Console.WriteLine($"counter: {counter} - i: {i} ");

                        if ((idFirst <= endIds[counter]) && idFirst > startIds[counter])
                        {
                            idFirst = startIds[counter];
                            counter = 0;
                        }
                        counter++;
                    }
                    //startIds.RemoveAt(counter);
                    //endIds.RemoveAt(counter);
                    if (startIds[i] != idFirst)
                    {
                        Console.WriteLine($"Id-Start {i} angepasst: {startIds[i]} jetzt {idFirst} ");
                        startIds[i] = idFirst;
                    }




                    //Console.WriteLine($"Id-Bereich: {startIds[i]} - {endIds[i]} ");
                }


                for (int i = 0; i < startIds.Count; i++)
                {
                    int counter2 = 0;
                    idFirst = startIds[i];
                    idEnd = endIds[i];
                    //Console.WriteLine($"checke ob bereich in bereich: {idFirst} - {idEnd} ");

                    while (counter2 < startIds.Count)
                    {
                        if ((idFirst >= startIds[counter2]) && idEnd <= endIds[counter2])
                        {
                            Console.WriteLine($"Line: {i} startId {idFirst} >: {startIds[counter2]} / endId {idEnd} <: {endIds[counter2]}");
                        }
                        counter2++;
                    }
                }

                for (int i = 0; i < startIds.Count; i++)
                {
                    long diff = (endIds[i] - startIds[i]) +1;
                    if(diff < 0)
                    {
                        Console.WriteLine($"diff ist minus!: {diff}");
                        break;
                    }

                    numberOfFreshIngredients += diff;
                }


                Console.WriteLine($"\nfreshIngredients: {numberOfFreshIngredients}");
            }
        }
        catch (Exception e)
        {
            Console.WriteLine("Fehler: " + e.Message);
        }
    }
}
